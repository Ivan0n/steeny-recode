<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MusicStream ‚Äî Steeny</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = { darkMode: 'class' };
  </script>

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link rel="stylesheet" href="{{ url_for('static', filename='home.css') }}">
  <link rel="icon" type="image/png" href="https://i.pinimg.com/736x/5a/d6/ef/5ad6ef496c7a7c342b9b0fdf2bce426a.jpg">

  <script src="{{ url_for('static', filename='themeloader.js') }}"></script>
</head>

<body class="flex flex-col min-h-screen text-[15px] theme-transition">
  <div class="flex flex-1">
    <aside class="w-60 border-r flex flex-col justify-between theme-transition" id="sidebar">
       <div>
         <div class="flex items-center gap-3 p-5 border-b border-gray-200 dark:border-gray-700 theme-transition">
           <div class="w-10 h-10 rounded flex items-center justify-center font-bold text-lg overflow-hidden">
             <img src="https://i.pinimg.com/736x/5a/d6/ef/5ad6ef496c7a7c342b9b0fdf2bce426a.jpg" alt="" class="w-full h-full object-cover">
           </div>
           <span class="font-bold text-lg">Steeny</span>
         </div>
         <nav id="menu" class="mt-6 flex flex-col gap-3 px-3 text-base">

            <div class="menu-link active" data-section="home">
              <i class="fa-solid fa-house w-5"></i> –ì–ª–∞–≤–Ω–∞—è
            </div>

            <div class="menu-link" data-section="search">
              <i class="fa-solid fa-magnifying-glass w-5"></i> –ü–æ–∏—Å–∫
            </div>

            <div class="menu-link" data-section="music">
              <i class="fa-solid fa-music w-5"></i> –ú—É–∑—ã–∫–∞
            </div>

            <div class="menu-link" data-section="favorites">
              <i class="fa-solid fa-heart w-5"></i> –õ—é–±–∏–º–æ–µ
            </div>

            <div class="menu-link" data-section="playlist">
              <i class="fa-solid fa-list w-5"></i> –ü–ª–µ–π–ª–∏—Å—Ç—ã
            </div>

            <div class="menu-link" data-section="settings">
              <i class="fa-solid fa-gear w-5"></i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏
            </div>

          </nav>
       </div>
    </aside>

    <main class="flex-1 flex flex-col theme-transition" style="padding-left: 240px;">
      <header class="flex justify-end items-center p-5 border-b border-gray-200 dark:border-gray-700 theme-transition">
        <a href="#" id="profileLink" class="flex items-center gap-4 cursor-pointer group">
          <span class="nameuser mr-4">{{ name }}</span>
          <img src="{{ avatar }}" class="w-10 h-10 rounded-full" alt="avatar">
        </a>
      </header>

      <div id="content" class="flex-1 overflow-y-auto p-8 theme-transition">
        
        <!-- –°–ï–ö–¶–ò–Ø: –ü—Ä–æ—Ñ–∏–ª—å -->
        <div id="section-profile" class="hidden">
          <div class="profile-header" style="background-image: url('{{ banner }}');">
            <div class="profile-overlay"></div>
            <div class="profile-info">
              <img src="{{ avatar }}" alt="User Avatar" class="profile-avatar fade-in">
              <div class="profile-text fade-up">
                <h1 class="profile-name">{{ name }}</h1>
                <p class="profile-id">ID: {{ user }}</p>
              </div>
            </div>
          </div>
          <div class="profile-content fade-up-delayed">
            <button class="menu-link inline-flex" data-section="settings">
              <i class="fa-solid fa-pencil"></i>
              –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
            </button>
          </div>
        </div>

        <!-- –°–ï–ö–¶–ò–Ø: –ì–ª–∞–≤–Ω–∞—è -->
        <div id="section-home">
          <h2 class="text-2xl font-bold mb-6">üëã –ü—Ä–∏–≤–µ—Ç, {{ name }}!</h2>
          
          <!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-8">
            
            <div class="quick-card" data-section="music">
              <div class="quick-card-icon bg-gradient-to-br from-purple-500 to-pink-500">
                <i class="fa-solid fa-music"></i>
              </div>
              <div class="quick-card-content">
                <h3 class="font-bold">–í—Å—è –º—É–∑—ã–∫–∞</h3>
                <p class="text-sm opacity-70">–°–ª—É—à–∞–π –≤—Å–µ —Ç—Ä–µ–∫–∏</p>
              </div>
              <i class="fa-solid fa-chevron-right opacity-40"></i>
            </div>

            <div class="quick-card" data-section="favorites">
              <div class="quick-card-icon bg-gradient-to-br from-red-500 to-orange-500">
                <i class="fa-solid fa-heart"></i>
              </div>
              <div class="quick-card-content">
                <h3 class="font-bold">–õ—é–±–∏–º–æ–µ</h3>
                <p class="text-sm opacity-70">–¢–≤–æ–∏ –∏–∑–±—Ä–∞–Ω–Ω—ã–µ —Ç—Ä–µ–∫–∏</p>
              </div>
              <i class="fa-solid fa-chevron-right opacity-40"></i>
            </div>

            <div class="quick-card" data-section="search">
              <div class="quick-card-icon bg-gradient-to-br from-blue-500 to-cyan-500">
                <i class="fa-solid fa-magnifying-glass"></i>
              </div>
              <div class="quick-card-content">
                <h3 class="font-bold">–ü–æ–∏—Å–∫</h3>
                <p class="text-sm opacity-70">–ù–∞–π–¥–∏ —á—Ç–æ-—Ç–æ –Ω–æ–≤–æ–µ</p>
              </div>
              <i class="fa-solid fa-chevron-right opacity-40"></i>
            </div>

          </div>

          <!-- –ù–µ–¥–∞–≤–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ (–≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π —Å–∫—Ä–æ–ª–ª) -->
          <div class="mb-8">
            <div class="flex items-center justify-between mb-4">
              <h3 class="font-bold text-lg">üÜï –ù–µ–¥–∞–≤–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ</h3>
              <button class="text-sm link" data-section="music">–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ ‚Üí</button>
            </div>
            <div class="cards-scroll-container">
              <button class="scroll-btn scroll-btn-left" data-direction="left">
                <i class="fa-solid fa-chevron-left"></i>
              </button>
              <div class="track-cards-wrapper" id="recentTracksWrapper">
                <div class="track-cards" id="recentTracksList">
                  <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ —Ç—Ä–µ–∫–æ–≤ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                </div>
              </div>
              <button class="scroll-btn scroll-btn-right" data-direction="right">
                <i class="fa-solid fa-chevron-right"></i>
              </button>
            </div>
          </div>

          <!-- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ -->
          <div class="theme-card">
            <div class="flex items-center gap-4">
              <div class="w-12 h-12 rounded-full bg-gradient-to-br from-yellow-400 to-orange-500 flex items-center justify-center text-white text-xl">
                <i class="fa-solid fa-heart"></i>
              </div>
              <div class="flex-1">
                <h3 class="font-bold">–ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å –ø—Ä–æ–µ–∫—Ç</h3>
                <p class="text-sm opacity-70">–ü–æ–º–æ–≥–∏ —Ä–∞–∑–≤–∏—Ç–∏—é Steeny</p>
              </div>
              <a href="https://dalink.to/ivan0n" target="_blank" class="form-button">
                <i class="fa-solid fa-gift mr-2"></i>–î–æ–Ω–∞—Ç
              </a>
            </div>
          </div>
        </div>

        <!-- –°–ï–ö–¶–ò–Ø: –ü–æ–∏—Å–∫ -->
        <div id="section-search" class="hidden">
          <h2 class="text-2xl font-bold mb-4">üîç –ü–æ–∏—Å–∫</h2>
          <div class="flex gap-2 mb-4">
            <input id="searchInput" type="text" placeholder="–ò—Å–∫–∞—Ç—å —Ç—Ä–µ–∫ –∏–ª–∏ –∞—Ä—Ç–∏—Å—Ç–∞..." class="flex-1 rounded theme-transition form-input">
            <button onclick="searchMusic()" class="px-4 py-2 bg-black text-white rounded hover:bg-gray-800 dark:bg-white dark:text-black dark:hover:bg-gray-200 theme-transition">–ò—Å–∫–∞—Ç—å</button>
          </div>
          <div class="theme-card">
            <div id="searchResults" class="track-list" style="overflow-x: hidden;"></div>
          </div>
        </div>

        <!-- –°–ï–ö–¶–ò–Ø: –ú—É–∑—ã–∫–∞ -->
        <div id="section-music" class="hidden">
          <h2 class="text-2xl font-bold mb-4">üé∂ –í—Å—è –º—É–∑—ã–∫–∞</h2>
          <div class="theme-card">
            <div class="flex items-center justify-between mb-4">
              <p class="text-sm opacity-70" id="trackCount">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
            </div>
            <div class="track-list" id="allTracksList" style="overflow-x: hidden;"></div>
          </div>
        </div>

        <!-- –°–ï–ö–¶–ò–Ø: –õ—é–±–∏–º–æ–µ -->
        <div id="section-favorites" class="hidden">
          <h2 class="text-2xl font-bold mb-4">‚ù§Ô∏è –õ—é–±–∏–º—ã–µ —Ç—Ä–µ–∫–∏</h2>
          <div class="theme-card">
            <div class="track-list" id="favoritesList" style="overflow-x: hidden;"></div>
          </div>
        </div>

        <!-- –°–ï–ö–¶–ò–Ø: –ü–ª–µ–π–ª–∏—Å—Ç—ã -->
        <div id="section-playlist" class="hidden">
          <h2 class="text-2xl font-bold mb-4">üìÅ –ü–ª–µ–π–ª–∏—Å—Ç—ã</h2>
          <div class="theme-card">
            <p class="p-4 text-center opacity-60">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –ø–ª–µ–π–ª–∏—Å—Ç–æ–≤</p>
            <button class="form-button mt-2">
              <i class="fa-solid fa-plus mr-2"></i>–°–æ–∑–¥–∞—Ç—å –ø–ª–µ–π–ª–∏—Å—Ç
            </button>
          </div>
        </div>

        <!-- –°–ï–ö–¶–ò–Ø: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ (–ò–°–ü–†–ê–í–õ–ï–ù–û) -->
        <div id="section-settings" class="hidden">
          <h2 class="text-2xl font-bold mb-4">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
          
          <!-- –í–∫–ª–∞–¥–∫–∏ -->
          <div class="flex gap-3 mb-6">
            <button class="settings-tab-btn active" data-tab="profile">–ü—Ä–æ—Ñ–∏–ª—å</button>
            <button class="settings-tab-btn" data-tab="themes">–¢–µ–º—ã</button>
          </div>
          
          <!-- –í–∫–ª–∞–¥–∫–∞: –ü—Ä–æ—Ñ–∏–ª—å -->
          <div id="settings-profile" class="settings-tab">
            <div class="settings-section">
              <h3 class="settings-section-title">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</h3>
              <form action="{{ url_for('update_name') }}" method="POST" class="settings-form">
                <label for="settings-name">–í–∞—à–µ –∏–º—è</label>
                <input type="text" id="settings-name" name="name" value="{{ name }}" required class="form-input">
                <button type="submit" class="form-button">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–º—è</button>
              </form>
            </div>
            
            <div class="settings-section">
              <h3 class="settings-section-title">–°–º–µ–Ω–∏—Ç—å –∞–≤–∞—Ç–∞—Ä</h3>
              <form action="{{ url_for('update_avatar') }}" method="POST" enctype="multipart/form-data" class="settings-form">
                <label for="settings-avatar">–ù–æ–≤—ã–π –∞–≤–∞—Ç–∞—Ä (jpg, png, gif)</label>
                <input type="file" id="settings-avatar" name="avatar" accept="image/*" required class="form-input file">
                <button type="submit" class="form-button">–ó–∞–≥—Ä—É–∑–∏—Ç—å –∞–≤–∞—Ç–∞—Ä</button>
              </form>
            </div>
            
            <div class="settings-section">
              <h3 class="settings-section-title">–°–º–µ–Ω–∏—Ç—å –±–∞–Ω–Ω–µ—Ä –ø—Ä–æ—Ñ–∏–ª—è</h3>
              <form action="{{ url_for('update_banner') }}" method="POST" enctype="multipart/form-data" class="settings-form">
                <label for="settings-banner">–ù–æ–≤—ã–π –±–∞–Ω–Ω–µ—Ä (jpg, png, gif)</label>
                <input type="file" id="settings-banner" name="banner" accept="image/*" required class="form-input file">
                <button type="submit" class="form-button">–ó–∞–≥—Ä—É–∑–∏—Ç—å –±–∞–Ω–Ω–µ—Ä</button>
              </form>
            </div>
            
            <div class="settings-section">
              <h3 class="settings-section-title">–°–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</h3>
              <form action="{{ url_for('update_password') }}" method="POST" class="settings-form">
                <label for="settings-old-password">–°—Ç–∞—Ä—ã–π –ø–∞—Ä–æ–ª—å</label>
                <input type="password" id="settings-old-password" name="old_password" required class="form-input">
                <label for="settings-new-password">–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</label>
                <input type="password" id="settings-new-password" name="new_password" required class="form-input">
                <button type="submit" class="form-button">–°–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</button>
              </form>
            </div>
          </div>

          <!-- –í–∫–ª–∞–¥–∫–∞: –¢–µ–º—ã -->
          <div id="settings-themes" class="settings-tab hidden">
            <div class="settings-section">
              <h3 class="settings-section-title">–¢–µ–º–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è</h3>
              <p class="text-sm opacity-70 mb-4">–í—ã–±–µ—Ä–∏—Ç–µ —Ü–≤–µ—Ç–æ–≤—É—é —Å—Ö–µ–º—É –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞</p>
              <div class="flex items-center gap-4 flex-wrap">
                <div class="theme-circle" data-theme="light" title="–°–≤–µ—Ç–ª–∞—è" style="background-color: #f3f4f6; border: 1px solid #d1d5db;"></div>
                <div class="theme-circle" data-theme="dark" title="–¢—ë–º–Ω–∞—è" style="background-color: #1f2937;"></div>
                <div class="theme-circle" data-theme="purple" title="–§–∏–æ–ª–µ—Ç–æ–≤–∞—è" style="background-color: #7e22ce;"></div>
                <div class="theme-circle" data-theme="green" title="–ó–µ–ª—ë–Ω–∞—è" style="background-color: #10b981;"></div>
                <div class="theme-circle" data-theme="blue" title="–°–∏–Ω—è—è" style="background-color: #3b82f6;"></div>
                <div class="theme-circle" data-theme="red" title="–ö—Ä–∞—Å–Ω–∞—è" style="background-color: #ef4444;"></div>
              </div>
            </div>
          </div>

          <!-- –í—ã—Ö–æ–¥ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞ -->
          <div class="settings-section mt-8">
            <a href="/logout" class="text-red-500 hover:underline inline-flex items-center gap-2">
              <i class="fa-solid fa-right-from-bracket"></i> –í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞
            </a>
          </div>
        </div>

      </div>
    </main>
  </div>

  <footer class="player border-t p-4 fixed bottom-0 left-0 right-0 z-50 bg-white dark:bg-gray-800 theme-transition">
    <div class="fullscreen-visuals">
        <button id="fullscreenCloseBtn" class="fullscreen-close-btn"><i class="fa-solid fa-compress"></i></button>
        <img id="fullscreenCoverImg" src="https://via.placeholder.com/300" class="fullscreen-cover" alt="cover">
        <div class="fullscreen-info">
            <div id="fullscreenTrackTitle" class="font-bold text-2xl">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–µ–∫–∞</div>
            <div id="fullscreenTrackArtist" class="text-lg opacity-80">–ê—Ä—Ç–∏—Å—Ç</div>
        </div>
    </div>
    
    <div class="player-content">
      <div class="mb-2">
        <input type="range" id="seekbar" class="seekbar" value="0" max="100">
        <div class="flex justify-between w-full text-xs text-gray-500 dark:text-gray-400 theme-transition">
          <span id="currentTime">0:00</span>
          <span id="duration">0:00</span>
        </div>
      </div>

      <div class="flex items-center justify-between">
        <div class="left-meta">
          <img id="coverImg" src="https://via.placeholder.com/64" class="w-14 h-14 rounded" alt="cover">
          <div>
            <div id="trackTitle" class="font-semibold text-sm">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–µ–∫–∞</div>
            <div id="trackArtist" class="text-xs text-gray-500 dark:text-gray-400 theme-transition">–ê—Ä—Ç–∏—Å—Ç</div>
          </div>
          <button id="favBtn" class="ml-3 text-2xl text-gray-400 hover:text-yellow-500"><i class="fa-solid fa-star"></i></button>
        </div>

        <div class="controls-center">
          <button id="prevBtn" class="player-btn"><i class="fa-solid fa-backward-step"></i></button>
          <button id="playBtn" class="player-btn play"><i id="playIcon" class="fa-solid fa-play"></i></button>
          <button id="nextBtn" class="player-btn"><i class="fa-solid fa-forward-step"></i></button>
          <button id="repeatBtn" class="player-btn"><i id="repeatIcon" class="fa-solid fa-repeat"></i></button>
        </div>

        <div class="right-volume">
          <i id="volumeIcon" class="fa-solid fa-volume-high"></i>
          <input type="range" id="volumeSlider" class="volume-slider" min="0" max="1" step="0.01" value="1">
          <button id="fullscreenBtn" class="player-btn small-btn ml-2"><i class="fa-solid fa-expand"></i></button>
        </div>
      </div>
    </div>
    
    <audio id="audioPlayer"></audio>
  </footer>

  <script type="module" src="{{ url_for('static', filename='music_player_js/homepage.js') }}"></script>
  <script type="module" src="{{ url_for('static', filename='music_player_js/media-session.js') }}"></script>
  <script src="{{ url_for('static', filename='profile.js') }}"></script>
</body>
</html>